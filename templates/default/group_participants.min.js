var xoctGroupParticipant={selected_id:0,data_url:"",container_available:null,container_per_group:null,lng:[delete_participant="Delete Participant?",select_group="Select Group",none_available="No Participants in this Group",none_available_all="No Participants available"],filter_container:null,filtering:!1,before_load:function(){},after_load:function(){},lngFromJson:function(t){this.lng=JSON.parse(t)},init:function(t,a,i,e,n){void 0!==e&&(this.before_load=e),void 0!==n&&(this.after_load=n),this.data_url=t,$(a).html('<ul id="xoct_available_participant" class="list-group"></ul>'),$(i).html('<ul id="xoct_group_participant" class="list-group"></ul>'),this.container_available=$("#xoct_available_participant"),this.container_per_group=$("#xoct_group_participant"),this.filter_container=$("#xoct_participant_filter"),this.load();var o=this;$(document).on("click",".xoct_add_user",function(){var t=$(this).parent().data("user-id");o.addUser(t)}),$(document).on("click",".xoct_remove_user",function(){var t=$(this).parent().data("id");o.removeUser(t)}),$.expr[":"].Contains=function(t,a,i){return $(t).text().toUpperCase().indexOf(i[3].toUpperCase())>=0},$.expr[":"].contains=function(t,a,i){return $(t).text().toUpperCase().indexOf(i[3].toUpperCase())>=0},this.filter_container.keyup(function(){o.filter($(this).val()),o.filtering&&!$("#xoct_filter").length?o.filter_container.after('<span class="input-group-btn"><button class="btn btn-default" id="xoct_filter" type="button"><span class="glyphicon glyphicon-remove"></span> </button></span>'):o.filtering||$("#xoct_filter").remove()}),$(document).on("click","#xoct_filter",function(){o.filter_container.val(""),o.filter(""),$(this).remove()})},removeUser:function(t){if(confirm(this.lng.delete_participant)){this.before_load();var a=this,i=this.data_url;$.ajax({url:i+"&cmd=delete",type:"POST",data:{id:t}}).done(function(t){a.after_load(),a.load(),a.loadForGroupId(xoctGroup.selected_id),xoctGroup.load(function(){},!0)})}},addUser:function(t){var a=xoctGroup.selected_id;if(0!=a){this.before_load();var i=this,e=this.data_url;$.ajax({url:e+"&cmd=create",type:"POST",data:{user_id:t,group_id:xoctGroup.selected_id}}).done(function(t){i.after_load(),i.load(),i.loadForGroupId(a),xoctGroup.load(function(){},!0)})}else alert(this.lng.select_group)},clear:function(){this.container_per_group.empty(),this.container_per_group.html('<li class="list-group-item">'+this.lng.select_group+"</li>")},load:function(){var t=this;this.before_load();var a=this.data_url;$.ajax({url:a,type:"GET",data:{cmd:"getAvailable",group_id:xoctGroup.selected_id}}).done(function(a){t.container_available.empty();for(var i in a)t.container_available.append('<li class="list-group-item xoct_participant_available" data-user-id="'+a[i].user_id+'"><div style="margin-right:30px;">'+a[i].display_name+'</div><button class="btn btn-primary xoct_add_user pull-right"><span class="glyphicon glyphicon-plus"></span></button></li>');a&&0!=a.length||t.container_available.html('<li class="list-group-item">'+t.lng.none_available_all+"</li>"),t.after_load()})},loadForGroupId:function(t){var a=this;this.before_load();var i=this.data_url;$.ajax({url:i,type:"GET",data:{cmd:"getPerGroup",group_id:t}}).done(function(t){a.container_per_group.empty();for(var i in t)a.container_per_group.append('<li class="list-group-item" data-id="'+t[i].id+'"><div style="margin-right:30px;">'+t[i].display_name+'</div><button class="btn btn-default xoct_remove_user pull-right"><span class="glyphicon glyphicon-minus"></span></button></li>');t&&0!=t.length||a.container_per_group.html('<li class="list-group-item">'+a.lng.none_available+"</li>"),a.after_load()})},filter:function(t){this.filtering=""!=t,$('.xoct_participant_available:not(:contains("'+t+'"))').hide(),$('.xoct_participant_available:contains("'+t+'")').show()}};