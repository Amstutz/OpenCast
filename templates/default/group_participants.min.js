var xoctGroupParticipant={selected_id:0,data_url:"",container_available:null,container_per_group:null,lng:[delete_participant="Delete Participant?",select_group="Select Group",none_available="No Participants in this Group",none_available_all="No Participants available"],filter_container:null,filtering:false,before_load:function(){},after_load:function(){},lngFromJson:function(a){this.lng=JSON.parse(a)},init:function(d,f,c,e,a){if(typeof e!="undefined"){this.before_load=e}if(typeof a!="undefined"){this.after_load=a}this.data_url=d;$(f).html('<ul id="xoct_available_participant" class="list-group"></ul>');$(c).html('<ul id="xoct_group_participant" class="list-group"></ul>');this.container_available=$("#xoct_available_participant");this.container_per_group=$("#xoct_group_participant");this.filter_container=$("#xoct_participant_filter");this.load();var b=this;$(document).on("click",".xoct_add_user",function(){var g=$(this).parent().data("user-id");b.addUser(g)});$(document).on("click",".xoct_remove_user",function(){var g=$(this).parent().data("id");b.removeUser(g)});$.expr[":"].Contains=function(h,j,g){return $(h).text().toUpperCase().indexOf(g[3].toUpperCase())>=0};$.expr[":"].contains=function(h,j,g){return $(h).text().toUpperCase().indexOf(g[3].toUpperCase())>=0};this.filter_container.keyup(function(){if(!b.filtering){b.filter_container.after('<span class="input-group-btn"><button class="btn btn-default" id="xoct_filter" type="button"><span class="glyphicon glyphicon-remove"></span> </button></span>')}b.filter($(this).val())});$(document).on("click","#xoct_filter",function(){b.filter_container.val("");b.filter("");$(this).remove()})},removeUser:function(c){if(confirm(this.lng.delete_participant)){this.before_load();var a=this;var b=this.data_url;$.ajax({url:b+"&cmd=delete",type:"POST",data:{id:c}}).done(function(d){a.after_load();a.load();a.loadForGroupId(xoctGroup.selected_id);xoctGroup.load(function(){},true)})}},addUser:function(a){var d=xoctGroup.selected_id;if(d==0){alert(this.lng.select_group);return}this.before_load();var b=this;var c=this.data_url;$.ajax({url:c+"&cmd=create",type:"POST",data:{user_id:a,group_id:xoctGroup.selected_id}}).done(function(e){b.after_load();b.load();b.loadForGroupId(d);xoctGroup.load(function(){},true)})},clear:function(){this.container_per_group.empty();this.container_per_group.html('<li class="list-group-item">'+this.lng.select_group+"</li>")},load:function(){var a=this;this.before_load();var b=this.data_url;$.ajax({url:b,type:"GET",data:{cmd:"getAvailable",group_id:xoctGroup.selected_id}}).done(function(d){a.container_available.empty();for(var c in d){a.container_available.append('<li class="list-group-item xoct_participant_available" data-user-id="'+d[c].user_id+'">'+d[c].display_name+'<button class="btn btn-primary xoct_add_user pull-right"><span class="glyphicon glyphicon-plus"></span></button></li>')}if(!d||d.length==0){a.container_available.html('<li class="list-group-item">'+a.lng.none_available_all+"</li>")}a.after_load()})},loadForGroupId:function(c){var a=this;this.before_load();var b=this.data_url;$.ajax({url:b,type:"GET",data:{cmd:"getPerGroup",group_id:c}}).done(function(e){a.container_per_group.empty();for(var d in e){a.container_per_group.append('<li class="list-group-item" data-id="'+e[d].id+'">'+e[d].display_name+'<button class="btn btn-default xoct_remove_user pull-right"><span class="glyphicon glyphicon-minus"></span></button></li>')}if(!e||e.length==0){a.container_per_group.html('<li class="list-group-item">'+a.lng.none_available+"</li>")}a.after_load()})},filter:function(a){this.filtering=(a!="");$('.xoct_participant_available:not(:contains("'+a+'"))').hide();$('.xoct_participant_available:contains("'+a+'")').show()}};